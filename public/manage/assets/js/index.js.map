{"version":3,"sources":["public/manage/assets/ts/index.ts","index.js","public/manage/assets/ts/ckeditor-loader.ts"],"names":["__SITE__","__MANAGE__","__UPLOADS__","__PAGE_SLUG__","window","addEventListener","event","document","querySelector","getAttribute","sidemenu_changer","filter_cat","getElementById","onchange","e","cat_id","target","value","location","href","pdf_upload_button","querySelectorAll","forEach","upload","files","pdf_filename","pdf_filename_label","hidden_base64","cancel","reader","FileReader","onload","result","innerText","name","style","visibility","readAsDataURL","cancel_button","onclick","filename","filename_label","base64","hidden_upped","pdf_preview_button","submit","set_current_time","now","Date","year","getFullYear","month","getMonth","date","getDate","hour","getHours","minute","getMinutes","published_date","published_time","button","action","confirm","bind_ids","on_send","Function","f","_i","ids_1","split","length","id","replace_value","elm","type","checked_elms","replace_values","_a","_b","Array","from","checked_elm","push","join","replace","params","form","target_form","spec_form","json","JSON","parse","keys_1","Object","keys","key","input","createElement","appendChild","$sideMenu","$sideMenuDiv","body","clientWidth","removeAttribute","classList","remove","setAttribute","add","ckeditor_load","allowedContentCommon","cke_1","CKEDITOR","allowedContent","enterMode","ENTER_BR","shiftEnterMode","ENTER_P","height","contentsCss","bodyClass","stylesSet","element","font_names","toolbar","removeButtons","filebrowserBrowseUrl","filebrowserImageBrowseUrl","filebrowserFlashBrowseUrl","filebrowserUploadUrl","filebrowserImageUploadUrl","filebrowserFlashUploadUrl","filebrowserUploadMethod","extraPlugins","removePlugins","autoGrow_minHeight","autoGrow_maxHeight","autoGrow_bottomSpace","templates","on","validon","send","editor","this","getData"],"mappings":"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","file":"index.js","sourcesContent":["\n// DOMロード時にPHP定義の一部を同期\nlet __SITE__: string;\nlet __MANAGE__: string;\nlet __UPLOADS__: string;\nlet __PAGE_SLUG__: string;\n\n/**\n * onload\n */\nwindow.addEventListener('DOMContentLoaded', function(event)\n{\n\t// PHP定義値の一部を、metaタグから取得する\n\t__SITE__ = <string>(<HTMLBaseElement>document.querySelector('meta[name=\"ashigaru:site\"]')).getAttribute('content');\n\t__MANAGE__ = <string>(<HTMLBaseElement>document.querySelector('meta[name=\"ashigaru:manage\"]')).getAttribute('content');\n\t__UPLOADS__ = <string>(<HTMLBaseElement>document.querySelector('meta[name=\"ashigaru:uploads\"]')).getAttribute('content');\n\t__PAGE_SLUG__ = <string>(<HTMLBaseElement>document.querySelector('meta[name=\"ashigaru:page_slug\"]')).getAttribute('content');\n\n\t// side menu changer\n\twindow.addEventListener('resize', sidemenu_changer)\n\tsidemenu_changer();\n\n\t// お知らせ管理のイベント登録\n\tif('news'===__PAGE_SLUG__) {\n\n\t\t// お知らせ管理のカテゴリ絞り込みプルダウンの挙動\n\t\tconst filter_cat = <HTMLInputElement>document.getElementById('filter-cat');\n\t\tif(filter_cat) {\n\t\t\tfilter_cat.onchange = e=>{\n\t\t\t\tconst cat_id = (<HTMLInputElement>e.target).value\n\t\t\t\tif(cat_id) {\n\t\t\t\t\tlocation.href = __MANAGE__+'/news/cat/'+cat_id+'/'\n\t\t\t\t} else {\n\t\t\t\t\tlocation.href = __MANAGE__+'/news/'\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// アップロードPDF選択時にサムネ更新（BASE64セット）\n\t\tconst pdf_upload_button = document.querySelectorAll('input.upload-pdf')\n\t\tif(pdf_upload_button) {\n\t\t\tpdf_upload_button.forEach(upload=>{\n\t\t\t\t(<HTMLInputElement>upload).onchange = e=>{\n\t\t\t\t\tconst upload = <HTMLInputElement>e.target\n\t\t\t\t\tconst files = upload.files\n\t\t\t\t\tconst pdf_filename = <HTMLInputElement>document.getElementById('pdf-filename');\n\t\t\t\t\tconst pdf_filename_label = <HTMLSpanElement>document.getElementById('pdf-filename-label');\n\t\t\t\t\tconst hidden_base64 = <HTMLInputElement>document.querySelector('[name='+'pdf_base64]');\n\t\t\t\t\tconst cancel = <HTMLDivElement>document.getElementById('pdf-cancel');\n\t\t\t\t\tconst reader = new FileReader();\n\t\t\t\t\treader.onload = e=>{\n\t\t\t\t\t\tif(e.target) {\n\t\t\t\t\t\t\thidden_base64.value = <string>e.target.result\n\t\t\t\t\t\t\tpdf_filename.value = pdf_filename_label.innerText = <string>files![0].name\n\t\t\t\t\t\t\tcancel.style.visibility = 'visible'\n\t\t\t\t\t\t\t// cancel.style.display = 'inline'\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(files && files[0]) reader.readAsDataURL(files[0]);\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\n\t\t// アップロードPDF選択後のキャンセルボタン処理\n\t\tconst cancel_button = document.querySelectorAll('button.cancel-button')\n\t\tif(cancel_button) {\n\t\t\tcancel_button.forEach(cancel=>{\n\t\t\t\t(<HTMLButtonElement>cancel).onclick = e=>{\n\t\t\t\t\tconst name = cancel.getAttribute('data-for');\n\t\t\t\t\t(<HTMLDivElement>document.getElementById(name+'-cancel')).style.visibility = 'hidden'\n\t\t\t\t\t// (<HTMLDivElement>document.getElementById(name+'-cancel')).style.display = 'none'\n\t\t\t\t\tconst filename = <HTMLInputElement>document.getElementById(name+'-filename');\n\t\t\t\t\tconst filename_label = <HTMLSpanElement>document.getElementById(name+'-filename-label');\n\t\t\t\t\t(<HTMLInputElement>document.querySelector('[name='+name+']')).value = '';\n\t\t\t\t\tconst base64 = <HTMLInputElement>document.querySelector('[name='+name+'_base64]');\n\t\t\t\t\tconst hidden_upped = <HTMLInputElement>document.querySelector('[name='+name+'_upped]');\n\t\t\t\t\tif(hidden_upped.value) {\n\t\t\t\t\t\tfilename.value = filename_label.innerText = hidden_upped.value\n\t\t\t\t\t\tbase64.value = ''\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfilename.value = filename_label.innerText = ''\n\t\t\t\t\t\tbase64.value = ''\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\n\t\t// PDFプレビューリンククリック\n\t\tconst pdf_preview_button = document.getElementById('pdf-preview-form-submit')\n\t\tif(pdf_preview_button) {\n\t\t\tpdf_preview_button.onclick = e => {\n\t\t\t\tconst hidden_base64 = <HTMLInputElement>document.getElementById('pdf-base64');\n\t\t\t\tconst hidden_base64_for_preview = <HTMLInputElement>document.getElementById('pdf-base64-for-preview');\n\t\t\t\thidden_base64_for_preview.value = hidden_base64.value\n\t\t\t\tconst pdf_filename = <HTMLInputElement>document.getElementById('pdf-filename');\n\t\t\t\tconst pdf_filename_for_preview = <HTMLInputElement>document.getElementById('pdf-filename-for-preview');\n\t\t\t\tpdf_filename_for_preview.value = pdf_filename.value\n\t\t\t\tconst form = <HTMLFormElement>document.getElementById('pdf-preview-form')\n\t\t\t\tform.submit()\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * 現在の日付をセットするボタン\n\t */\n\tvar set_current_time = document.getElementById('set-current-time')\n\tif(set_current_time) {\n\t\tset_current_time.onclick = function(e) {\n\t\t\tconst now = new Date();\n\t\t\tconst year      = now.getFullYear()\n\t\t\tconst month     = (now.getMonth()+1) < 10 ? '0'+(now.getMonth()+1) : (now.getMonth()+1)\n\t\t\tconst date      = (now.getDate() < 10 ? '0'+now.getDate() : now.getDate())\n\t\t\tconst hour      = (now.getHours() < 10 ? '0'+now.getHours() : now.getHours())\n\t\t\tconst minute    = (now.getMinutes() < 10 ? '0'+now.getMinutes() : now.getMinutes());\n\t\t\tvar published_date = <HTMLInputElement>document.querySelector('[name=published_date]')\n\t\t\tif(published_date) published_date.value = year+'-'+month+'-'+date;\n\t\t\tvar published_time = <HTMLInputElement>document.querySelector('[name=published_time]')\n\t\t\tif(published_time) published_time.value = hour+':'+minute;\n\t\t}\n\t}\n\n\t/**\n\t * データ操作ボタン：GET\n\t * ex.\n\t *    <button type=\"button\"\n\t *        data-get-action=\"/delete/y/%s/m/%s/\"\n\t *        data-bind-ids=\"year,month\" // URLの%sに置き換えたい順で要素のidを指定。checkboxはカンマ連結\n\t *        data-on-send='alert('xxx'); retrun false' // 送信前に実行する関数\n\t *        data-confirm='ページを移動しますか？' // 任意\n\t *    >\n\t*/\n\tdocument.querySelectorAll('[data-get-action]').forEach(button=>{\n\t\t(<HTMLButtonElement>button).onclick = e=>{\n\t\t\tlet action = button.getAttribute('data-get-action')\n\t\t\tconst confirm = button.getAttribute('data-confirm')\n\t\t\tconst bind_ids = button.getAttribute('data-bind-ids')\n\t\t\tconst on_send = button.getAttribute('data-on-send')\n\t\t\tif(on_send) {\n\t\t\t\tvar f = Function(on_send)\n\t\t\t\tif(false===f()) return false\n\t\t\t}\n\t\t\tif(action) {\n\t\t\t\tif(confirm && !window.confirm(confirm)) return\n\t\t\t\tif(bind_ids) {\n\t\t\t\t\tconst ids = bind_ids.split(/,\\s+/)\n\t\t\t\t\tfor(let id of ids) {\n\t\t\t\t\t\tlet replace_value = ''\n\t\t\t\t\t\tconst elm = <HTMLInputElement>document.querySelector('[id='+id+']')\n\t\t\t\t\t\tif(elm) {\n\t\t\t\t\t\t\tif('radio'===elm.type || 'checkbox'===elm.type) {\n\t\t\t\t\t\t\t\tconst checked_elms = document.querySelectorAll('[id='+id+']:checked')\n\t\t\t\t\t\t\t\tlet replace_values = []\n\t\t\t\t\t\t\t\tfor(var checked_elm of Array.from(checked_elms)) {\n\t\t\t\t\t\t\t\t\treplace_values.push((<HTMLInputElement>checked_elm).value)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\treplace_value = replace_values.join(',')\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\treplace_value = elm.value;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\taction = action.replace(/%s/, replace_value)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tlocation.href = action\n\t\t\t}\n\t\t}\n\t})\n\n\t/**\n\t * データ操作ボタン：POST\n\t * ex.\n\t *    <button type=\"button\"\n\t *        data-post-action=\"/delete/\"\n\t *        data-params='{\"entry_id\":<?= $entry->id ?>}'\n\t *        data-confirm='ID<?= $entry->id ?>の記事を削除していい？' // 任意\n\t *        data-target-form='post-action-form'\n\t *    >\n\t*/\n\tdocument.querySelectorAll('[data-post-action]').forEach(button=>{\n\t\t(<HTMLButtonElement>button).onclick = e=>{\n\n\t\t\t// 各種データ変数セット\n\t\t\tconst action = button.getAttribute('data-post-action')\n\t\t\tconst confirm = button.getAttribute('data-confirm')\n\t\t\tconst params = button.getAttribute('data-params')\n\t\t\tlet form = <HTMLFormElement>document.getElementById('post-action-form')\n\n\t\t\t// 送信に使うフォームを #post-action-form 以外のものに指定した場合\n\t\t\tif(!form) {\n\t\t\t\tconst target_form = button.getAttribute('data-target-form')\n\t\t\t\tif(target_form) {\n\t\t\t\t\tconst spec_form = <HTMLFormElement>document.getElementById(target_form)\n\t\t\t\t\tif(spec_form) form = spec_form\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// フォームにPOSTするクエリデータをhidden要素にしてセット\n\t\t\tif(params) {\n\t\t\t\tconst json = JSON.parse(params)\n\t\t\t\tconst keys = Object.keys(json)\n\t\t\t\tfor(let key of keys) {\n\t\t\t\t\tconst input = document.createElement('input');\n\t\t\t\t\tinput.type = \"hidden\"\n\t\t\t\t\tinput.name = key\n\t\t\t\t\tinput.value = json[key]\n\t\t\t\t\tform.appendChild(input);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// フォームをPOST送信する\n\t\t\tif(action) {\n\t\t\t\tif(confirm && !window.confirm(confirm)) return\n\t\t\t\tform.action = action\n\t\t\t\tform.submit()\n\t\t\t}\n\t\t}\n\t})\n})\n\n/**\n * サイドメニュー部分を、PCの場合は通常表示、SPの場合はUIKitのOffCanvasを利用するように切り替える\n */\nfunction sidemenu_changer()\n{\n\tvar $sideMenu = document.querySelector('#side-menu');\n\tif(!$sideMenu) return;\n\tvar $sideMenuDiv = document.querySelector('#side-menu>div.oc-wrap');\n\tif(960<document.body.clientWidth) {\n\t\tif(!$sideMenu.getAttribute('uk-offcanvas')) return;\n\t\t$sideMenu.removeAttribute('uk-offcanvas');\n\t\t$sideMenu.classList.remove('uk-offcanvas')\n\t\t$sideMenuDiv?.classList.remove('uk-offcanvas-bar')\n\t} else {\n\t\tif($sideMenu.getAttribute('uk-offcanvas')) return;\n\t\t$sideMenu.setAttribute('uk-offcanvas', 'mode:push; flip:true; overlay:true');\n\t\t$sideMenuDiv?.classList.add('uk-offcanvas-bar')\n\t}\n}\n",null,"\n// CKEditorローダ\nwindow.addEventListener('DOMContentLoaded', function(event){\n    document.querySelectorAll('[data-ckeditor]').forEach(elm=>ckeditor_load(<HTMLTextAreaElement>elm))\n})\n\nconst allowedContentCommon = true;\n// let allowedContentCommon =\n// \t'div(*){*};'+\n// \t'p(*){*};'+\n// \t'span(*){*};'+\n// \t'strong(*);'+\n// \t'em(*);'+\n// \t'u(*);'+\n// \t's(*);'+\n// \t'a(*)[!href];'+ // hrefが入ってないAタグは無視するという意味\n// \t'img(*)[*];'+\n// \t'table(*)[*];'+\n// \t'thead(*)[*];'+\n// \t'tbody(*)[*];'+\n// \t'tfoot(*)[*];'+\n// \t'tr(*)[*];'+\n// \t'th(*)[*];'+\n// \t'td(*)[*];'+\n// \t'caption(*)[*];'+\n// \t'ul(*);'+\n// \t'ol(*);'+\n// \t'li(*);'+\n// \t'dl(*);'+\n// \t'dt(*);'+\n// \t'dd(*);'+\n// \t'blockquote(*);'\n// ;\n\nfunction ckeditor_load(target: HTMLTextAreaElement)\n{\n    // 本文用（色、太字、画像アップロードなど）\n    if ('content'===target.getAttribute('data-ckeditor')) {\n\n        // PHP定義値の一部を、metaタグから取得する\n        __SITE__ = <string>(<HTMLBaseElement>document.querySelector('meta[name=\"ashigaru:site\"]')).getAttribute('content');\n        __MANAGE__ = <string>(<HTMLBaseElement>document.querySelector('meta[name=\"ashigaru:manage\"]')).getAttribute('content');\n        __UPLOADS__ = <string>(<HTMLBaseElement>document.querySelector('meta[name=\"ashigaru:uploads\"]')).getAttribute('content');\n\n        let cke = CKEDITOR.replace(target,\n            {\n                allowedContent: allowedContentCommon,\n\n                enterMode: CKEDITOR.ENTER_BR,\n                shiftEnterMode: CKEDITOR.ENTER_P,\n\n                // width: 600,\n                height: 350,\n\n                // editor content css\n                contentsCss: __SITE__+'/assets/css/ckeditor-add.css?20220912',\n                bodyClass: 'page',\n                // bodyId: document.querySelector('body.news')\n                //     ? 'newsCo'\n                //     : 'voiceCo'\n                // ,\n\n                // style set\n                // stylesSet: 'my_styles',\n\n                stylesSet: [\n                    // { name: 'リード文', element: 'p', attributes: { class: 'p-txtUnit__txt' } },\n                    { name: 'h3 見出し', element: 'h3' },\n                    { name: 'h4 中見出し', element: 'h4' },\n                    { name: 'h5 小見出し', element: 'h5' },\n                    { name: 'p 段落', element: 'p' },\n                ],\n\n                font_names: 'ＭＳ Ｐゴシック;ＭＳ Ｐ明朝;ＭＳ ゴシック;ＭＳ 明朝;游ゴシック;游明朝;',\n\n                // // icons\n                // toolbarGroups: [\n                // \t// { name: 'styles', groups: ['styles'] },\n                // \t// { name: 'clipboard',   groups: [ 'clipboard', 'undo' ] },\n                // \t// { name: 'editing',     groups: [ 'find', 'selection', 'spellchecker', 'editing' ] },\n                // \t// { name: 'forms',       groups: [ 'forms' ] },\n                // \t{ name: 'basicstyles', groups: ['basicstyles', 'cleanup'] },\n                // \t{ name: 'colors', groups: ['colors'] },\n                // \t// { name: 'paragraph',   groups: [ 'list', 'indent', 'blocks', 'align', 'bidi', 'paragraph' ] },\n                // \t{ name: 'links', groups: ['links'] },\n                // \t{ name: 'insert', groups: ['insert'] },\n                // \t// { name: 'tools',       groups: [ 'tools' ] },\n                // \t// { name: 'others',      groups: [ 'others' ] },\n                // \t// { name: 'about',       groups: [ 'about' ] },\n                // \t{ name: 'document', groups: ['mode', 'document', 'doctools'] }\n                // ],\n\n                toolbar: document.querySelector('body.news')\n                    ? // お知らせ用\n                    [\n                        // ['Styles', 'Font', 'FontSize'],\n                        ['Bold', 'Underline', 'Strike', 'RemoveFormat'],\n                        ['JustifyLeft', 'JustifyCenter', 'JustifyRight'],\n                        ['TextColor', 'BGColor'],\n                        ['BulletedList', 'NumberedList'],\n                        ['Link', 'Unlink'],\n                        ['Image', 'Table'],\n                        ['Source'],\n                    ]\n                    : // お客様の声用\n                    [\n                        // ['Styles', 'Font', 'FontSize'],\n                        ['Styles'],\n                        ['Bold', 'Underline', 'Strike', 'RemoveFormat'],\n                        ['JustifyLeft', 'JustifyCenter', 'JustifyRight'],\n                        ['TextColor', 'BGColor'],\n                        ['BulletedList', 'NumberedList'],\n                        ['Link', 'Unlink'],\n                        ['Image', 'Table'],\n                        ['Source'],\n                    ],\n\n                removeButtons: 'Templates,Save,NewPage,Preview,Print,Cut,Undo,Redo,Copy,Paste,PasteText,PasteFromWord,Find,SelectAll,Scayt,Replace,Form,Checkbox,Radio,TextField,Textarea,Select,Button,ImageButton,HiddenField,Subscript,Superscript,CopyFormatting,Outdent,Indent,Blockquote,CreateDiv,BidiLtr,BidiRtl,Language,Anchor,Flash,HorizontalRule,Smiley,SpecialChar,PageBreak,Iframe,Format,ShowBlocks,Maximize,About',\n\n                // for KCFinder\n                filebrowserBrowseUrl:      __MANAGE__+'/assets/kcfinder/browse.php?type=files',\n                filebrowserImageBrowseUrl: __MANAGE__+'/assets/kcfinder/browse.php?type=images',\n                filebrowserFlashBrowseUrl: __MANAGE__+'/assets/kcfinder/browse.php?type=flash',\n                filebrowserUploadUrl:      __MANAGE__+'/assets/kcfinder/upload.php?type=files',\n                filebrowserImageUploadUrl: __MANAGE__+'/assets/kcfinder/upload.php?type=images',\n                filebrowserFlashUploadUrl: __MANAGE__+'/assets/kcfinder/upload.php?type=flash',\n                filebrowserUploadMethod:   'form',\n\n                // plugins\n                extraPlugins: 'autogrow,widget,lineutils,image2,justify,colorbutton,font',\n                removePlugins: 'image',\n\n                // plugin: Auto Grow\n                autoGrow_minHeight: 500,\n                autoGrow_maxHeight: 500,\n                autoGrow_bottomSpace: 50,\n\n                // templates\n                templates: 'default',\n            })\n        ;\n        // フォーカスアウト時に自動的にValidon実行する関数\n        cke.on('blur', function(e: any) {\n            (<any>window).validon.send(e.editor.name)\n        } );\n        // textareaにデータを強制同期する関数を用意（フォーカス移さずにバリデートする直前に実行など）\n        (<any>target)['ckeSync'] = function() {\n            return this.value = cke.getData()\n        }\n    }\n}\n"]}