# Do not edit this file as it will update automatically !
# Built by Lampman ver 1.0.29 @ 2023-11-14 5:53:36
version: '2.2'
services:
  lampman:
    container_name: lampman-kz-ashigaru-lampman
    image: kazaoki/lampman
    ports:
      - '80:80'
      - '443:443'
      - '9981:1080'
    depends_on:
      - phpenv
    environment:
      LAMPMAN_MODE: default
      LAMPMAN_APACHE_START: 1
      LAMPMAN_APACHE_REWRITE_LOG: 0
      LAMPMAN_PHP_PHPENV_IMAGE: 'kazaoki/phpenv:8.0.8'
      LAMPMAN_PHP_PHPENV_VERSION: 8.0.8
      LAMPMAN_PHP_ERROR_REPORT: 1
      LAMPMAN_PHP_XDEBUG_START: 1
      LAMPMAN_PHP_XDEBUG_HOST: host.docker.internal
      LAMPMAN_PHP_XDEBUG_PORT: 9000
      LAMPMAN_MAILDEV_START: 1
      LAMPMAN_MAILDEV_PORTS: '9981:1080'
      LAMPMAN_POSTFIX_START: 1
      LAMPMAN_BIND_HOSTS: 'main.db:lampman-kz-ashigaru-mysql'
      LAMPMAN_MYSQLS: mysql
    volumes_from:
      - phpenv
    volumes:
      - './:/lampman'
      - '../public:/var/www/html'
    entrypoint: /lampman/lampman/entrypoint.sh
  phpenv:
    container_name: lampman-kz-ashigaru-phpenv
    image: 'kazaoki/phpenv:8.0.8'
    labels:
      - label=lampman-kz-ashigaru
  mysql:
    container_name: lampman-kz-ashigaru-mysql
    image: 'mysql:5.7'
    ports:
      - '3306:3306'
    volumes:
      - './mysql:/mysql'
      - 'mysql_data:/var/lib/mysql'
      - './mysql/dump.sql:/docker-entrypoint-initdb.d/dump.sql'
    entrypoint: /mysql/entrypoint.sh
    command:
      - mysqld
      - '--character-set-server=utf8mb4'
      - '--collation-server=utf8mb4_general_ci'
    labels:
      - label=lampman-kz-ashigaru
    environment:
      MYSQL_ROOT_PASSWORD: test
      MYSQL_DATABASE: test
      MYSQL_USER: test
      MYSQL_PASSWORD: test
      VOLUME_LOCKED: 0
      DUMP_ROTATIONS: 3
      DUMP_FILENAME: dump.sql
volumes:
  mysql_data:
    driver: local
    name: lampman-kz-ashigaru-mysql_data
networks: {}
